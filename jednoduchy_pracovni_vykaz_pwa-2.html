<!DOCTYPE html>
<html lang="cs">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pracovní výkaz</title>
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; background:#f5f5f5; margin:0; padding:16px; }
    h1 { font-size:20px; margin-bottom:12px; }
    .card { background:#fff; border-radius:12px; padding:16px; margin-bottom:12px; box-shadow:0 2px 6px rgba(0,0,0,.08); }
    label { font-size:14px; display:block; margin-top:8px; }
    input { width:100%; font-size:16px; padding:8px; margin-top:4px; }
    button { margin-top:12px; width:100%; padding:12px; font-size:16px; border:none; border-radius:10px; background:#007aff; color:#fff; }
    table { width:100%; border-collapse:collapse; margin-top:12px; font-size:14px; }
    th, td { border-bottom:1px solid #ddd; padding:6px; text-align:center; }
    tfoot td { font-weight:bold; }
  </style>
</head>
<body>

<h1>Pracovní výkaz</h1>

<div class="card">
  <label>Datum</label>
  <input type="number" id="day" min="1" max="31" />

  <label>Nástup</label>
  <input type="time" id="start" />

  <label>Konec</label>
  <input type="time" id="end" />

  <label>Kilometry</label>
  <input type="number" id="km" />

  <button onclick="addRow()">Přidat</button>
</div>

<div class="card">
  <table id="table">
    <thead>
      <tr>
        <th>Den</th>
        <th>Hodiny</th>
        <th>Km</th>
        <th>Kč práce</th>
        <th>Kč km</th>
      </tr>
    </thead>
    <tbody></tbody>
    <tfoot>
      <tr>
        <td>CELKEM</td>
        <td id="th"></td>
        <td id="tkm"></td>
        <td id="tp"></td>
        <td id="tpk"></td>
      </tr>
    </tfoot>
  </table>
</div>

<script>
let totalH = 0, totalKm = 0, totalP = 0, totalPk = 0;

// Načtení uložených dat
const saved = JSON.parse(localStorage.getItem('vykazData') || '[]');
saved.forEach(r => restoreRow(r));

function addRow() {
  const day = dayInput.value;
  const s = start.value;
  const e = end.value;
  const km = Number(kmInput.value || 0);

  if (!day || !s || !e) return alert('Vyplň datum, nástup a konec');

  const [sh, sm] = s.split(':').map(Number);
  const [eh, em] = e.split(':').map(Number);
  const hours = ((eh*60+em)-(sh*60+sm))/60;

  const price = Math.round(hours * 400);
  const priceKm = Math.round(km * 11);

  totalH += hours;
  totalKm += km;
  totalP += price;
  totalPk += priceKm;

  const tr = document.createElement('tr');
  tr.innerHTML = `<td>${day}</td><td>${hours.toFixed(2)}</td><td>${km}</td><td>${price}</td><td>${priceKm}</td>`;
  document.querySelector('tbody').appendChild(tr);

  // Uložit řádek do paměti
  const data = JSON.parse(localStorage.getItem('vykazData') || '[]');
  data.push({ day, hours, km, price, priceKm });
  localStorage.setItem('vykazData', JSON.stringify(data));

  th.textContent = totalH.toFixed(2);
  tkm.textContent = totalKm;
  tp.textContent = totalP;
  tpk.textContent = totalPk;

  dayInput.value = start.value = end.value = kmInput.value = '';
}

function restoreRow(r) {
  totalH += r.hours;
  totalKm += r.km;
  totalP += r.price;
  totalPk += r.priceKm;

  const tr = document.createElement('tr');
  tr.innerHTML = `<td>${r.day}</td><td>${r.hours.toFixed(2)}</td><td>${r.km}</td><td>${r.price}</td><td>${r.priceKm}</td>`;
  document.querySelector('tbody').appendChild(tr);

  th.textContent = totalH.toFixed(2);
  tkm.textContent = totalKm;
  tp.textContent = totalP;
  tpk.textContent = totalPk;
}

const dayInput = document.getElementById('day');
const start = document.getElementById('start');
const end = document.getElementById('end');
const kmInput = document.getElementById('km');
</script>

</body>
</html>
